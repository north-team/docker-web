(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-32b0a0ea"],{1099:function(e,t,n){},"5d6b":function(e,t,n){},"9de1":function(e,t,n){"use strict";var i=n("5d6b"),r=n.n(i);r.a},bd5d:function(e,t,n){"use strict";var i=n("1099"),r=n.n(i);r.a},ec0e:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("GenericListPage",{ref:"GenericListPage",attrs:{"table-config":e.tableConfig,"header-actions":e.headerActions}}),e._v(" "),n("GenericUpdateFormDialog",{attrs:{"selected-rows":e.updateSelectedDialogSetting.selectedRows,"form-setting":e.updateSelectedDialogSetting.formSetting,visible:e.updateSelectedDialogSetting.visible},on:{"update:visible":function(t){return e.$set(e.updateSelectedDialogSetting,"visible",t)},update:e.handleDialogUpdate}}),e._v(" "),n("InviteUsersDialog",{attrs:{setting:e.InviteDialogSetting},on:{close:e.handleInviteDialogClose}})],1)},r=[],s=(n("1c01"),n("58b2"),n("8e6e"),n("f3e2"),n("d25f"),n("ac6a"),n("456d"),n("96cf"),n("3b8d")),a=n("bd86"),o=(n("8ea5"),n("6d67"),n("d92a"),n("2f62")),l=n("cd4a"),c=n("2934"),u=n("cf45"),d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.setting.InviteDialogVisible?n("Dialog",{attrs:{title:this.$t("users.InviteUserInOrg"),visible:e.setting.InviteDialogVisible,"custom-class":"asset-select-dialog","show-cancel":!1,"show-confirm":!1,width:"28%",top:"15vh",after:"","destroy-on-close":!0},on:{"update:visible":function(t){return e.$set(e.setting,"InviteDialogVisible",t)},close:e.clearSelect}},[n("div",[n("el-select",{attrs:{multiple:"",filterable:"",remote:"",size:"small","reserve-keyword":"",placeholder:this.$t("setting.usernamePlaceholder"),"remote-method":e.remoteMethod,loading:e.selectLoading},model:{value:e.InviteValue,callback:function(t){e.InviteValue=t},expression:"InviteValue"}},e._l(e.InviteOptions,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),e._v(" "),n("el-collapse-transition",[e.InviteValue.length>0?n("div",{staticStyle:{"margin-top":"15px",display:"flex","flex-direction":"column","align-items":"center","justify-content":"center"}},[n("el-checkbox-group",{staticStyle:{display:"flex","flex-direction":"row","justify-content":"center"},attrs:{size:"small"},model:{value:e.rulesList,callback:function(t){e.rulesList=t},expression:"rulesList"}},[n("el-checkbox",{attrs:{label:"User",checked:""}},[e._v(e._s(e.$t("users.OrgUser")))]),e._v(" "),n("el-checkbox",{attrs:{label:"Auditor"}},[e._v(e._s(e.$t("users.OrgAuditor")))]),e._v(" "),n("el-checkbox",{attrs:{label:"Admin"}},[e._v(e._s(e.$t("users.OrgAdmin")))])],1),e._v(" "),n("el-button",{staticStyle:{"margin-top":"20px",width:"10vw"},attrs:{type:"primary",loading:e.InviteLoading,size:"small"},on:{click:e.InviteConfirm}},[e._v(e._s(e.$t("users.Invite")))])],1):e._e()])],1)]):e._e()},v=[],f=(n("ac4d"),n("8a81"),n("7f7f"),n("9039"));function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){Object(a["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m={components:{Dialog:f["a"]},props:{setting:{type:Object,default:function(){return{InviteDialogVisible:!1}}}},data:function(){return{selectLoading:!1,InviteLoading:!1,InviteOptions:[],InviteValue:[],rulesList:[]}},computed:g({},Object(o["b"])(["currentOrg","currentUser","device"])),methods:{remoteMethod:function(e){var t=this;""!==e?(this.InviteOptions=[],this.selectLoading=!0,this.$axios.get(" /api/v1/users/users/suggestion/?search=".concat(e)).then((function(e){for(var n=0;n<e.length;n++)t.InviteOptions.push({value:e[n].id,label:e[n].name+"("+e[n].username+")"})})).finally((function(){t.selectLoading=!1}))):this.InviteOptions=[]},clearSelect:function(){this.InviteValue=[],this.rulesList=[],this.InviteOptions=[]},InviteConfirm:function(){var e=this;this.InviteLoading=!0;var t=[],n=!0,i=!1,r=void 0;try{for(var s,a=this.rulesList[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var o=s.value,l=!0,c=!1,u=void 0;try{for(var d,v=this.InviteValue[Symbol.iterator]();!(l=(d=v.next()).done);l=!0){var f=d.value;t.push({user:f,role:o})}}catch(p){c=!0,u=p}finally{try{l||null==v.return||v.return()}finally{if(c)throw u}}}}catch(p){i=!0,r=p}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}this.$axios.post("/api/v1/users/users/invite/",t).then((function(){e.$message.success(e.$t("common.AddSuccessMsg"))})).finally((function(){e.InviteLoading=!1,e.clearSelect(),e.$emit("close")}))}}},h=m,b=(n("9de1"),n("2877")),O=Object(b["a"])(h,d,v,!1,null,"2856f837",null),w=O.exports;function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){Object(a["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S={components:{InviteUsersDialog:w,GenericListPage:l["f"],GenericUpdateFormDialog:l["i"]},data:function(){var e=this,t=this,n=function(){return t.currentUserIsSuperAdmin},i=function(){return!!t.publicSettings.XPACK_LICENSE_IS_VALID&&!t.currentOrgIsRoot};return{tableConfig:{url:"/api/v1/users/users/",columns:["name","username","email","phone","wechat","groups_display","total_role_display","source","is_valid","login_blocked","mfa_enabled","mfa_force_enabled","is_expired","last_login","date_joined","date_password_last_updated","comment","created_by","actions"],columnsShow:{min:["name","username","actions"],default:["name","username","groups_display","total_role_display","source","is_valid","actions"]},columnsMeta:{username:{showOverflowTooltip:!0},email:{showOverflowTooltip:!0},source:{width:"120px"},total_role_display:{label:this.$t("users.Role"),showOverflowTooltip:!0},mfa_enabled:{label:"MFA",formatterArgs:{showFalse:!1}},mfa_force_enabled:{formatterArgs:{showFalse:!1}},is_expired:{formatterArgs:{showFalse:!1}},groups_display:{width:"200px",showOverflowTooltip:!0},actions:{formatterArgs:{canClone:!0,hasDelete:n,canUpdate:function(e){var t=e.row;return t["can_update"]},canDelete:function(e){var t=e.row;return t["can_delete"]},extraActions:[{title:this.$t("users.Remove"),name:"remove",type:"warning",has:i,can:function(e){var t=e.row;return t.can_delete},callback:this.removeUserFromOrg}]}}}},headerActions:{hasBulkDelete:n,canCreate:!0,extraActions:[{name:this.$t("users.InviteUser"),title:this.$t("users.InviteUser"),has:function(){return!e.currentOrgIsRoot&&e.publicSettings.XPACK_LICENSE_IS_VALID},callback:function(){this.InviteDialogSetting.InviteDialogVisible=!0}.bind(this)}],extraMoreActions:[{title:this.$t("common.removeSelected"),name:"removeSelected",has:i,can:function(e){var t=e.selectedRows;return t.length>0},callback:this.bulkRemoveCallback.bind(this)},{name:"disableSelected",title:this.$t("common.disableSelected"),can:function(e){var t=e.selectedRows;return t.length>0},callback:function(e){var n=e.selectedRows,i=e.reloadTable,r="/api/v1/users/users/",s=n.map((function(e){return{id:e.id,is_active:!1}}));0!==s.length&&t.$axios.patch(r,s).then((function(){i()}))}},{name:"activateSelected",title:this.$t("common.activateSelected"),can:function(e){var t=e.selectedRows;return t.length>0},callback:function(e){var n=e.selectedRows,i=e.reloadTable,r="/api/v1/users/users/",s=n.map((function(e){return{id:e.id,is_active:!0}}));0!==s.length&&t.$axios.patch(r,s).then((function(){i()}))}},{name:"updateSelected",title:this.$t("common.updateSelected"),can:function(e){var n=e.selectedRows;return n.length>0&&!t.currentOrgIsRoot},callback:function(e){var n=e.selectedRows;e.reloadTable;t.updateSelectedDialogSetting.visible=!0,t.updateSelectedDialogSetting.selectedRows=n}}]},updateSelectedDialogSetting:{selectedRows:[],visible:!1,formSetting:{initial:{date_expired:Object(u["g"])(36500,new Date).toISOString()},fields:["groups","date_expired","comment"],hasSaveContinue:!1,url:"/api/v1/users/users/",fieldsMeta:{groups:{label:this.$t("users.UserGroups"),hidden:function(){return t.currentOrgIsRoot},el:{multiple:!0,ajax:{url:"/api/v1/users/groups/"},value:[]}},date_expired:{label:this.$t("common.dateExpired"),hidden:function(){return!1}},comment:{label:this.$t("common.Comment"),hidden:function(){return!1}}}}},InviteDialogSetting:{InviteDialogVisible:!1}}},computed:y({},Object(o["b"])(["currentOrgIsRoot","currentUser","publicSettings","device","currentOrgIsDefault","currentUserIsSuperAdmin"])),methods:{removeUserFromOrg:function(e){var t=this,n=e.row,i=(e.col,e.reload),r="/api/v1/users/users/".concat(n.id,"/remove/");this.$axios.post(r).then((function(){i(),t.$message.success(t.$t("common.removeSuccessMsg"))}))},bulkRemoveCallback:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var n,i,r,s,a,o=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.selectedRows,i=t.reloadTable,r=n.map((function(e){return e.id})),e.next=4,Object(c["a"])(r);case 4:s=e.sent,a="".concat(this.tableConfig.url,"remove/?spm=")+s.spm,this.$axios.post(a).then((function(){i(),o.$message.success(o.$t("common.removeSuccessMsg"))}));case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),handleInviteDialogClose:function(){this.InviteDialogSetting.InviteDialogVisible=!1,this.$refs.GenericListPage.$refs.ListTable.$refs.ListTable.reloadTable()},handleDialogUpdate:function(){this.$refs.GenericListPage.$refs.ListTable.$refs.ListTable.reloadTable()}}},I=S,D=(n("bd5d"),Object(b["a"])(I,i,r,!1,null,"d72d9bc2",null));t["default"]=D.exports}}]);