(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6ef2a9a9"],{"326c":function(t,e,s){},"685f":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("GenericDetailPage",t._g(t._b({attrs:{object:t.ticket,"active-menu":t.config.activeMenu},on:{"update:object":function(e){t.ticket=e},"update:activeMenu":function(e){return t.$set(t.config,"activeMenu",e)},"update:active-menu":function(e){return t.$set(t.config,"activeMenu",e)}}},"GenericDetailPage",t.config,!1),t.$listeners),[s(t.config.activeMenu,{tag:"component",attrs:{object:t.ticket}})],1)},a=[],n=s("cd4a"),c=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("GenericTicketDetail",{attrs:{object:t.object,"detail-card-items":t.detailCardItems,"special-card-items":t.specialCardItems,"assigned-card-items":t.assignedCardItems,approve:t.handleApprove,close:t.handleClose,reject:t.handleReject}})},o=[],r=(s("57e7"),s("ed08")),u=s("cf45"),l=s("0218"),d=s("9cdc"),p={name:"",components:{GenericTicketDetail:d["a"]},props:{object:{type:Object,default:function(){return{}}}},data:function(){return{statusMap:"open"===this.object.status?l["e"]["notified"]:l["e"][this.object.state],requestForm:{node:this.object.meta.apply_nodes,asset:this.object.meta.apply_assets,systemuser:this.object.meta.apply_system_users},comments:"",assets:[]}},computed:{detailCardItems:function(){var t=this,e=this.$createElement,s=this.object||{};return[{key:this.$t("common.Number"),value:s.serial_num},{key:this.$t("tickets.status"),value:s.state,formatter:function(s,i){return e("el-tag",{attrs:{type:t.statusMap.type,size:"mini"}},[" ",t.statusMap.title])}},{key:this.$t("tickets.type"),value:s.type_display},{key:this.$t("tickets.user"),value:s["applicant_display"]},{key:this.$t("tickets.OrgName"),value:s.org_name},{key:this.$t("common.dateCreated"),value:Object(u["q"])(s.date_created)},{key:this.$t("common.Comment"),value:s.comment}]},specialCardItems:function(){var t,e,s,i=this.object.meta||{};return[{key:this.$t("perms.Node"),value:(null===i||void 0===i||null===(t=i.apply_nodes_display)||void 0===t?void 0:t.join(", "))||""},{key:this.$t("tickets.Asset"),value:(null===i||void 0===i||null===(e=i.apply_assets_display)||void 0===e?void 0:e.join(", "))||""},{key:this.$t("tickets.SystemUser"),value:(null===i||void 0===i||null===(s=i.apply_system_users_display)||void 0===s?void 0:s.join(", "))||""},{key:this.$t("assets.Action"),value:Object(u["d"])(this,i["apply_actions_display"])},{key:this.$t("common.dateStart"),value:Object(u["q"])(i.apply_date_start)},{key:this.$t("common.dateExpired"),value:Object(u["q"])(i.apply_date_expired)}]},assignedCardItems:function(){var t,e,s,i=this.$createElement,a=this,n=this.object.meta||{};return[{key:this.$t("tickets.PermissionName"),value:this.object.meta.apply_permission_name,formatter:function(t,e){var s={name:"AssetPermissionDetail",params:{id:a.object.id},query:{oid:a.object.org_id}};return"closed"===a.object.status&&"approved"===a.object.state?i("router-link",{attrs:{to:s}},[e]):i("span",[e])}},{key:this.$t("perms.Node"),value:(null===n||void 0===n||null===(t=n.apply_nodes_display)||void 0===t?void 0:t.join(", "))||""},{key:this.$t("assets.Asset"),value:(null===n||void 0===n||null===(e=n.apply_assets_display)||void 0===e?void 0:e.join(", "))||""},{key:this.$t("tickets.SystemUser"),value:(null===n||void 0===n||null===(s=n.apply_system_users_display)||void 0===s?void 0:s.join(", "))||""},{key:this.$t("assets.Action"),value:Object(u["d"])(this,n["apply_actions_display"])},{key:this.$t("common.dateStart"),value:Object(u["q"])(null===n||void 0===n?void 0:n.apply_date_start)},{key:this.$t("common.dateExpired"),value:Object(u["q"])(null===n||void 0===n?void 0:n.apply_date_expired)}]},hasActionPerm:function(){return-1!==this.object.assignees.indexOf(this.$store.state.users.profile.id)}},methods:{formatTime:function(t){return Object(r["a"])(Object(r["b"])(t))},toSafeLocalDateStr:function(t){return Object(u["q"])(t)},reloadPage:function(){window.location.reload()},handleApprove:function(){var t=this,e=this.requestForm.asset.length,s=this.requestForm.node.length;return 0===e&&0===s?this.$message.error(this.$tc("common.SelectAtLeastOneAssetOrNodeErrMsg")):0===this.requestForm.systemuser.length?this.$message.error(this.$tc("common.RequiredSystemUserErrMsg")):void this.$axios.put("/api/v1/tickets/tickets/".concat(this.object.id,"/approve/"),{meta:{}}).then((function(){t.$message.success(t.$tc("common.updateSuccessMsg")),t.reloadPage()})).catch((function(){t.$message.success(t.$tc("common.updateErrorMsg"))}))},handleClose:function(){var t=this,e="/api/v1/tickets/tickets/".concat(this.object.id,"/close/");this.$axios.put(e).then((function(e){return t.reloadPage()})).catch((function(e){return t.$message.error(e)}))},handleReject:function(){var t=this,e="/api/v1/tickets/tickets/".concat(this.object.id,"/reject/");this.$axios.put(e).then((function(e){return t.reloadPage()})).catch((function(e){return t.$message.error(e)}))}}},m=p,h=(s("b627"),s("2877")),v=Object(h["a"])(m,c,o,!1,null,"1a948d2a",null),y=v.exports,k={components:{GenericDetailPage:n["e"],TicketDetail:y,TabPage:n["m"]},data:function(){return{ticket:{title:"",user_display:"",type_display:"",status:"",processor:"",date_created:""},config:{activeMenu:"TicketDetail",url:"",submenu:[{title:this.$t("route.TicketDetail"),name:"TicketDetail"}],actions:{detailApiUrl:"/api/v1/tickets/tickets/".concat(this.$route.params.id,"/")},getObjectName:this.getObjectName,hasRightSide:!1}}},methods:{getObjectName:function(){return this.ticket.title}}},f=k,j=Object(h["a"])(f,i,a,!1,null,"52604557",null);e["default"]=j.exports},b627:function(t,e,s){"use strict";var i=s("326c"),a=s.n(i);a.a}}]);