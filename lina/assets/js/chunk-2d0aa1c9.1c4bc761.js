(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0aa1c9"],{"102f":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("GenericDetailPage",e._g(e._b({attrs:{object:e.app,"active-menu":e.config.activeMenu},on:{"update:object":function(t){e.app=t},"update:activeMenu":function(t){return e.$set(e.config,"activeMenu",t)},"update:active-menu":function(t){return e.$set(e.config,"activeMenu",t)},"tab-click":e.TabClick}},"GenericDetailPage",e.config,!1),e.$listeners),[s("keep-alive",[s(e.config.activeMenu,{tag:"component",attrs:{object:e.app}})],1)],1)},i=[],o=(s("7f7f"),s("cd4a")),c=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{md:14,sm:24}},[s("ListTable",{ref:"ListTable",attrs:{"table-config":e.tableConfig,"header-actions":e.headerActions}})],1),e._v(" "),s("el-col",{attrs:{md:10,sm:24}},[s("RelationCard",e._b({attrs:{type:"primary"}},"RelationCard",e.remoteAppRelationConfig,!1)),e._v(" "),s("RelationCard",e._b({staticStyle:{"margin-top":"15px"},attrs:{type:"info"}},"RelationCard",e.systemUserRelationConfig,!1))],1)],1)},n=[],r=(s("57e7"),s("20d6"),s("d25f"),s("75fc")),l=(s("ac4d"),s("8a81"),s("ac6a"),s("6d67"),s("579c")),p=s("58fd"),u=s("e975"),m={name:"ApplicationsPermission",components:{ListTable:l["a"],RelationCard:p["a"]},props:{object:{type:Object,default:function(){return{}}}},data:function(){var e=this,t=this;return{tableConfig:{url:"/api/v1/perms/application-permissions/".concat(this.object.id,"/applications/all/"),columns:["application_display","delete_action"],columnsMeta:{application_display:{label:this.$t("assets.Applications"),align:"center"},delete_action:{prop:"application",label:this.$t("common.Actions"),align:"center",width:150,objects:this.object.applications,formatter:u["f"],deleteUrl:"/api/v1/perms/application-permissions-applications-relations/?applicationpermission=".concat(this.$route.params.id,"&application=")}},tableAttrs:{border:!1}},headerActions:{hasLeftActions:!1,hasExport:!1,hasImport:!1},remoteAppRelationConfig:{icon:"fa-edit",title:this.$t("perms.addApplicationToThisPermission"),disabled:this.$store.getters.currentOrgIsRoot,objectsAjax:{url:"/api/v1/applications/applications/?category=".concat(this.object.category,"&type=").concat(this.object.type),transformOption:function(e){return{label:e.name+" ("+e.type_display+")",value:e.id}}},hasObjectsId:this.object.applications,showHasObjects:!1,performAdd:function(t){var s=e.object.id,a="/api/v1/perms/application-permissions-applications-relations/",i=t.map((function(e){return e.value})),o=[],c=!0,n=!1,r=void 0;try{for(var l,p=i[Symbol.iterator]();!(c=(l=p.next()).done);c=!0){var u=l.value;o.push({applicationpermission:s,application:u})}}catch(m){n=!0,r=m}finally{try{c||null==p.return||p.return()}finally{if(n)throw r}}return e.$axios.post(a,o)},onAddSuccess:function(t,s){e.$log.debug("Select value",s.select2.value),s.iHasObjects=[].concat(Object(r["a"])(s.iHasObjects),Object(r["a"])(t)),s.$refs.select2.clearSelected(),e.$message.success(e.$t("common.updateSuccessMsg")),e.$refs.ListTable.reloadTable()}},systemUserRelationConfig:{icon:"fa-edit",title:this.$t("perms.addSystemUserToThisPermission"),objectsAjax:{url:"remote_app"===t.object.category?"/api/v1/assets/system-users/?protocol=rdp":"/api/v1/assets/system-users/?protocol=".concat(t.object.type),transformOption:function(e){return{label:e.name+" ("+e.username+")",value:e.id}}},hasObjectsId:this.object.system_users,performAdd:function(t){var s=e.object.id,a="/api/v1/perms/application-permissions/".concat(s,"/"),i=e.object.system_users;t.map((function(e){return i.push(e.value)}));var o={system_users:i};return e.$axios.patch(a,o)},onAddSuccess:function(t,s){e.$log.debug("Select value",s.select2.value),s.iHasObjects=[].concat(Object(r["a"])(s.iHasObjects),Object(r["a"])(t)),s.$refs.select2.clearSelected(),e.$message.success(e.$tc("common.updateSuccessMsg")),e.$refs.ListTable.reloadTable()},performDelete:function(t){var s=e.object.id,a="/api/v1/perms/application-permissions/".concat(s,"/"),i=e.object.system_users,o=i.filter((function(e){return e!==t.value}));if(0!==o.length){var c={system_users:o};return e.$axios.patch(a,c)}e.$message.error(e.$tc("common.lastCannotBeDeleteMsg"))},onDeleteSuccess:function(t,s){var a=s.iHasObjects.findIndex((function(e){return e.value===t.value}));s.iHasObjects.splice(a,1);while(-1!==s.select2.disabledValues.indexOf(t.value)){var i=s.select2.disabledValues.indexOf(t.value);e.$log.debug("disabled values remove index: ",i),s.select2.disabledValues.splice(i,1)}e.$message.success(e.$t("common.deleteSuccessMsg")),e.$refs.ListTable.reloadTable()}}}}},d=m,b=s("2877"),f=Object(b["a"])(d,c,n,!1,null,"e8e6844a",null),h=f.exports,v=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:14}},[s("DetailCard",{attrs:{items:e.detailCardItems}})],1),e._v(" "),s("el-col",{attrs:{span:10}},[s("QuickActions",{attrs:{type:"primary",actions:e.quickActions}})],1)],1)},g=[],j=(s("d92a"),s("b97b")),$=s("8c34"),y=s("cf45"),_={name:"RemoteAppPermissionDetail",components:{DetailCard:j["a"],QuickActions:$["a"]},props:{object:{type:Object,default:function(){return{}}}},data:function(){return{quickActions:[{title:this.$t("common.Active"),type:"switcher",attrs:{model:this.object.is_active},callbacks:{change:function(e){var t=this;this.$axios.patch("/api/v1/perms/application-permissions/".concat(this.object.id,"/"),{is_active:e}).then((function(e){t.$message.success(t.$t("common.updateSuccessMsg"))})).catch((function(e){t.$message.error(t.$t("common.updateErrorMsg "+e))}))}.bind(this)}}]}},computed:{detailCardItems:function(){return[{key:this.$t("common.Name"),value:this.object.name},{key:this.$t("assets.Applications"),value:this.object.category_display},{key:this.$t("perms.userCount"),value:this.object.users_amount},{key:this.$t("perms.userGroupCount"),value:this.object.user_groups_amount},{key:this.$t("perms.appsCount"),value:this.object.applications_amount},{key:this.$t("perms.systemUserCount"),value:this.object.system_users_amount},{key:this.$t("perms.dateStart"),value:Object(y["q"])(this.object.date_start)},{key:this.$t("common.dateExpired"),value:Object(y["q"])(this.object.date_expired)},{key:this.$t("common.dateCreated"),value:Object(y["q"])(this.object.date_created)},{key:this.$t("common.createdBy"),value:this.object.created_by},{key:this.$t("common.Comment"),value:this.object.comment}]}}},A=_,O=Object(b["a"])(A,v,g,!1,null,"03db7c18",null),C=O.exports,x=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{md:14,sm:24}},[s("ListTable",{ref:"ListTable",attrs:{"table-config":e.tableConfig,"header-actions":e.headerActions}})],1),e._v(" "),s("el-col",{attrs:{md:10,sm:24}},[s("RelationCard",e._b({attrs:{type:"primary"}},"RelationCard",e.userRelationConfig,!1)),e._v(" "),s("RelationCard",e._b({staticStyle:{"margin-top":"15px"},attrs:{type:"info"}},"RelationCard",e.groupRelationConfig,!1))],1)],1)},S=[],T={name:"RemoteAppPermissionUser",components:{ListTable:l["a"],RelationCard:p["a"]},props:{object:{type:Object,default:function(){return{}}}},data:function(){var e=this;return{tableConfig:{url:"/api/v1/perms/application-permissions/".concat(this.object.id,"/users/all/"),columns:["user_display","delete_action"],columnsMeta:{user_display:{label:this.$t("perms.User"),align:"center"},delete_action:{prop:"user",label:this.$t("common.Actions"),align:"center",width:150,objects:this.object.users,formatter:u["f"],deleteUrl:"/api/v1/perms/application-permissions-users-relations/?applicationpermission=".concat(this.object.id,"&user=")}},tableAttrs:{border:!1}},headerActions:{hasLeftActions:!1,hasExport:!1,hasImport:!1},userRelationConfig:{icon:"fa-user",title:this.$t("perms.addUserToThisPermission"),objectsAjax:{url:"/api/v1/users/users/?fields_size=mini",transformOption:function(e){return{label:e.name+"("+e.username+")",value:e.id}}},hasObjectsId:this.object.users,showHasObjects:!1,performAdd:function(t){var s=e.object.id,a="/api/v1/perms/application-permissions-users-relations/",i=t.map((function(e){return e.value})),o=[],c=!0,n=!1,r=void 0;try{for(var l,p=i[Symbol.iterator]();!(c=(l=p.next()).done);c=!0){var u=l.value;o.push({applicationpermission:s,user:u})}}catch(m){n=!0,r=m}finally{try{c||null==p.return||p.return()}finally{if(n)throw r}}return e.$axios.post(a,o)},onAddSuccess:function(t,s){e.$log.debug("Select value",s.select2.value),s.iHasObjects=[].concat(Object(r["a"])(s.iHasObjects),Object(r["a"])(t)),s.$refs.select2.clearSelected(),e.$message.success(e.$t("common.updateSuccessMsg")),e.$refs.ListTable.reloadTable()}},groupRelationConfig:{icon:"fa-group",title:this.$t("perms.addUserGroupToThisPermission"),objectsAjax:{url:"/api/v1/users/groups/"},hasObjectsId:this.object.user_groups,performAdd:function(t){var s=e.object.id,a="/api/v1/perms/application-permissions/".concat(s,"/"),i=e.object.user_groups;t.map((function(e){return i.push(e.value)}));var o={user_groups:i};return e.$axios.patch(a,o)},onAddSuccess:function(t,s){e.$log.debug("Select value",s.select2.value),s.iHasObjects=[].concat(Object(r["a"])(s.iHasObjects),Object(r["a"])(t)),s.$refs.select2.clearSelected(),e.$message.success(e.$t("common.updateSuccessMsg")),e.$refs.ListTable.reloadTable()},performDelete:function(t){var s=e.object.id,a="/api/v1/perms/application-permissions/".concat(s,"/");e.object.user_groups=e.object.user_groups.filter((function(e){return e!==t.value}));var i={user_groups:e.object.user_groups};return e.$axios.patch(a,i)},onDeleteSuccess:function(t,s){var a=s.iHasObjects.findIndex((function(e){return e.value===t.value}));s.iHasObjects.splice(a,1);while(-1!==s.select2.disabledValues.indexOf(t.value)){var i=s.select2.disabledValues.indexOf(t.value);e.$log.debug("disabled values remove index: ",i),s.select2.disabledValues.splice(i,1)}e.$message.success(e.$t("common.deleteSuccessMsg")),e.$refs.ListTable.reloadTable()}}}}},k=T,R=Object(b["a"])(k,x,S,!1,null,"a9128898",null),P=R.exports,w={components:{ApplicationsPermission:h,ApplicationPermissionDetail:C,ApplicationPermissionUser:P,GenericDetailPage:o["e"],TabPage:o["m"]},data:function(){var e=this;return{app:{type:"",category:"",id:""},config:{activeMenu:"ApplicationPermissionDetail",submenu:[{title:this.$t("common.BasicInfo"),name:"ApplicationPermissionDetail"},{title:this.$t("perms.usersAndUserGroups"),name:"ApplicationPermissionUser"},{title:this.$t("perms.appsList"),name:"ApplicationsPermission"}],actions:{detailApiUrl:"/api/v1/perms/application-permissions/".concat(this.$route.params.id,"/"),deleteApiUrl:"/api/v1/perms/application-permissions/".concat(this.$route.params.id,"/"),updateCallback:function(){var t={name:"ApplicationPermissionUpdate",query:{type:e.app.type,category:e.app.category},params:{id:e.app.id}};e.$router.push(t)}}}}},methods:{TabClick:function(e){"ApplicationPermissionDetail"!==e.name?this.$set(this.config,"hasRightSide",!1):this.$set(this.config,"hasRightSide",!0)}}},M=w,U=Object(b["a"])(M,a,i,!1,null,"abd89498",null);t["default"]=U.exports}}]);