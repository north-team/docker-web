(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3660f115"],{"35c8":function(e,t,a){},"7e21":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.loading?e._e():a("GenericCreateUpdatePage",e._b({attrs:{"perform-submit":e.performSubmit,"create-success-next-route":e.createSuccessNextRoute}},"GenericCreateUpdatePage",e.$data,!1))},l=[],s=(a("96cf"),a("3b8d")),p=(a("6762"),a("2fdb"),a("2caf"),a("6d67"),a("768b")),r=(a("7f7f"),a("8ea5"),a("cd4a")),o=a("56f5"),n=a("cf45"),c=a("7541"),u={components:{GenericCreateUpdatePage:r["d"]},data:function(){var e=this,t=this,a=new Date,i=Object(n["i"])(7,a).toISOString(),l=a.toISOString(),s=[];return{hasDetailInMsg:!1,loading:!0,initial:{ips_or_not:!0,meta:{apply_date_expired:i,apply_date_start:l,apply_actions:["all","connect","updownload","upload_file","download_file"]},org_id:"",type:"apply_application"},fields:[[this.$t("common.Basic"),["title","type","org_id","comment"]],[this.$t("tickets.RequestPerm"),["meta"]]],fieldsMeta:{type:{hidden:function(){return!0},el:{disabled:!0}},meta:{fields:["apply_category_type","apply_applications","apply_system_users","apply_date_start","apply_date_expired"],fieldsMeta:{apply_date_start:{label:this.$t("common.DateStart"),type:"date-picker",el:{type:"datetime"}},apply_applications:{type:"assetSelect",component:o["a"],label:this.$t("applications.App"),el:{value:[],ajax:{url:"",transformOption:function(e){return{label:e.name,value:e.id}}}}},apply_system_users:{type:"systemUserSelect",component:o["a"],label:this.$t("assets.SystemUser"),el:{value:[],ajax:{url:"",transformOption:function(t){if("k8s"===e.$route.query.type)return{label:t.name,value:t.id};var a=t.username||"*";return{label:t.name+"("+a+")",value:t.id}}}}},apply_date_expired:{label:this.$t("common.DateEnd"),type:"date-picker",el:{type:"datetime"}},apply_category_type:{type:"cascader",label:this.$t("applications.appType"),rules:[c["b"]],el:{multiple:!1,options:this.getApplyCategoryType()},on:{change:function(a,i){var l=Object(p["a"])(a,1),s=l[0];e.apply_category_type=s,i({apply_applications:[],apply_system_users:[]}),e.fieldsMeta.meta.fieldsMeta.apply_applications.el.ajax.url="/api/v1/applications/applications/suggestion/?oid=".concat(t.org_id,"&category=").concat(s[0],"&type=").concat(s[1]),e.fieldsMeta.meta.fieldsMeta.apply_system_users.el.ajax.url="remote_app"===s[0]?"/api/v1/assets/system-users/suggestion/?oid=".concat(t.org_id,"&protocol=rdp"):"/api/v1/assets/system-users/suggestion/?oid=".concat(t.org_id,"&protocol=").concat(s[1])}}}}},org_id:{component:o["a"],el:{multiple:!1,options:this.$store.state.users.profile.user_all_orgs.map((function(e){return{label:e.name,value:e.id}}))},hidden:function(a){e.org_id=a["org_id"],s=e.apply_category_type,s&&(e.fieldsMeta.meta.fieldsMeta.apply_applications.el.ajax.url="/api/v1/applications/applications/suggestions/?oid=".concat(t.org_id,"&category=").concat(s[0],"&type=").concat(s[1]),e.fieldsMeta.meta.fieldsMeta.apply_system_users.el.ajax.url="remote_app"===s[0]?"/api/v1/assets/system-users/suggestions/?oid=".concat(t.org_id,"&protocol=rdp"):"/api/v1/assets/system-users/suggestions/?oid=".concat(t.org_id,"&protocol=").concat(s[1]))}}},url:"/api/v1/tickets/tickets/?type=apply_application&action=open",createSuccessNextRoute:{name:"TicketList"},cleanFormValue:function(e){var t=e.meta.apply_applications,a=e.meta.apply_system_users;return t&&Array.isArray(t)&&t.length<1&&delete e.meta.apply_applications,a&&Array.isArray(a)&&a.length<1&&delete e.meta.apply_system_users,e}}},mounted:function(){var e=this.$store.state.users.profile["user_all_orgs"],t=this.$store.getters.currentOrg?this.$store.getters.currentOrg.id:null;e=e?e.map((function(e){return e.id})):[],e.length>0&&(e.includes(t)?this.initial.org_id=t:this.initial.org_id=e[0]),this.loading=!1},methods:{performSubmit:function(e){var t=e.meta,a=t.apply_category_type,i=function(e,i){return a&&a.length>0?a[e]:t[i]};return t.apply_category=i(0,"apply_category"),t.apply_type=i(1,"apply_type"),delete t["apply_category_type"],this.$axios["post"]("/api/v1/tickets/tickets/open/?type=apply_application",e)},handleApplyCategoryType:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a,i,l,s,p,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=[{label:this.$t("applications.applicationsCategory.db"),value:"db",children:[{label:"MySQL",value:"mysql",disabled:!0},{label:"Oracle",value:"oracle",disabled:!0},{label:"PostgreSQL",value:"postgresql",disabled:!0},{label:"MariaDB",value:"mariadb",disabled:!0},{label:"SQLServer",value:"sqlserver",disabled:!0},{label:"Redis",value:"redis",disabled:!0}]},{label:this.$t("applications.applicationsCategory.cloud"),value:"cloud",children:[{label:"Kubernetes",value:"k8s",disabled:!0}]},{label:this.$t("applications.applicationsCategory.remote_app"),value:"remote_app",children:[{label:"MySQL Workbench",value:"mysql_workbench",disabled:!0},{label:"vSphere Client",value:"vmware_client",disabled:!0},{label:"Custom",value:"custom",disabled:!0},{label:"Chrome",value:"chrome",disabled:!0}]}],a="/api/v1/applications/applications/?action=category",e.next=4,this.$axios.get(a);case 4:for(l in i=e.sent,i)for(s in t)if(p=t[s].children,r=t[s].value,r===i[l].category)for(o in p)p[o].value===i[l].type&&(p[o].disabled=!1);return e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getApplyCategoryType:function(){var e=[];return this.handleApplyCategoryType().then((function(t){t.map((function(t){return e.push(t)}))})),e}}},d=u,y=(a("daef"),a("2877")),_=Object(y["a"])(d,i,l,!1,null,"5821c462",null);t["default"]=_.exports},daef:function(e,t,a){"use strict";var i=a("35c8"),l=a.n(i);l.a}}]);